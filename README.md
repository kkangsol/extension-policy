# ❎Extension Policy Management Mini Project

협업툴 및 내부 시스템에서 파일 업로드 기능을 제공할 때 발생할 수 있는  
보안 이슈를 예방하기 위해 **파일 확장자 차단 정책을 관리하는 기능**을 구현한 미니 프로젝트입니다.

단순한 CRUD 구현이 아니라,  
**요구사항 분석 → 정책 설계 → 예외 및 검증 규칙 정의 → 구현 → 배포**  
까지의 사고 과정을 중심으로 진행했습니다.

---

## 🔍 프로젝트 배경

파일 업로드 기능은 협업툴에서 필수적이지만,  
`exe`, `sh` 등 실행 가능한 파일이 업로드될 경우  
서버 실행·악성 코드 유입 등의 보안 사고로 이어질 수 있습니다.

따라서 관리자가 업로드 파일 확장자를 차단하는 기능을 아래의 정책을 기반으로 구현했습니다.

- 자주 차단되는 확장자는 **고정 확장자(FIXED)** 로 관리
- 상황에 따라 관리자가 직접 추가/삭제할 수 있는 **커스텀 확장자(CUSTOM)** 제공
- 차단 상태 변경은 즉시 반영되고, 새로고침 이후에도 유지
- 중복 입력, 잘못된 입력 등 **예외 상황을 서버 단에서 방어**

---

## 🎯 프로젝트 목표

- 고정 확장자 / 커스텀 확장자 정책 분리
- 정책 변경 시 즉시 반영 및 상태 일관성 유지
- 입력값 정규화 및 중복/예외 처리
- 검토자가 별도의 로컬 실행 없이 바로 확인할 수 있도록 배포까지 완료

---

## 🔗 Live Demo

- Service URL: https://extension-policy.onrender.com
- Swagger UI: https://extension-policy.onrender.com/swagger-ui/index.html

> Render Free 플랜 특성상 첫 접속 시 약간의 지연이 발생할 수 있습니다.
> 해당 화면에서 잠시만 기다려주세요.
> <img width="1847" height="733" alt="image" src="https://github.com/user-attachments/assets/baae9935-41e0-4667-8f0e-ec51fde1d57c" />


---

## 🧭 요구사항 분석 및 설계 과정

### 1️⃣ 요구사항 정의

제공된 과제 요건을 그대로 구현하기보다는,  
기능·프로세스·화면·데이터 관점으로 나누어 Excel로 **요구사항 정의서**를 직접 정리했습니다.

<img width="1599" height="423" alt="image" src="https://github.com/user-attachments/assets/5a838178-96fd-4ebc-a00d-7139013e683e" />


#### 고정 확장자 요구사항
- 시스템 사전 정의 확장자 목록
- 기본 상태는 `unchecked`
- 체크/해제 시 즉시 DB에 저장
- 새로고침/재접속 시 동일한 상태 유지
- 커스텀 확장자 영역에는 노출되지 않음

#### 커스텀 확장자 요구사항
- 관리자가 직접 입력하여 추가
- 동일 확장자 중복 등록 불가
- 입력 길이 최대 20자 제한
- 최대 200개까지 관리 가능
- 삭제(X) 버튼 제공
- 새로고침 이후에도 상태 유지

> 요구사항 정의서는 Excel로 정리하여  
> 구현 범위와 예외 조건을 명확히 했습니다.

---

### 2️⃣ 정책 흐름 및 예외 사항 정리

요구사항을 바탕으로  
확장자 정책의 흐름과 예외 상황을 러프한 시퀀스 형태로 정리했습니다.

<img width="1000" height="1324" alt="image" src="https://github.com/user-attachments/assets/06b8a788-de9a-493c-a653-7413f5735472" />
<img width="1382" height="1000" alt="image" src="https://github.com/user-attachments/assets/7955fbbd-866d-40b0-97fc-9a6cbd7833ed" />


- 고정 확장자: 삭제 불가, 차단 상태만 변경 가능
- 커스텀 확장자: 추가/삭제 가능
- 정책 변경 후 항상 DB 조회 결과 기준으로 화면 렌더링
- 입력/상태 변경 시 정책 일관성 유지

---

## 🗄️ 데이터베이스 구조

확장자 정책 관리에 집중하기 위해 단일 테이블 구조로 설계했습니다.

### Extension Table

| 컬럼명 | 설명 |
|------|------|
| id | 확장자 식별자 |
| ext | 확장자 이름 |
| type | FIXED / CUSTOM |
| blocked | 차단 여부 |
| createdAt | 생성일 |
| updatedAt | 수정일 |

- FIXED 확장자는 애플리케이션 시작 시 시딩
- CUSTOM 확장자는 관리자 입력으로 관리
- 차단 상태는 DB에 저장되어 항상 동일한 정책 상태 보장

---

## 🛠️ 기술 스택

### Backend
- **Spring Boot**
  - REST API 기반 정책 관리
- **Spring Data JPA**
  - 정책 데이터 영속성 처리

### Database
- **H2 (In-Memory)**
  - 데모 환경에서 외부 DB 의존성 제거
  - 서버 재시작 시 데이터 초기화
  - 고정 확장자 시딩으로 기본 정책 상태 보장

### Frontend
- **HTML / JavaScript**
  - 정책 관리 화면 구성
  - API 호출 기반 상태 변경

### Deployment
- **Render**
  - 검토자 접근 편의를 위한 공개 URL 제공
  - Docker 기반 배포로 실행 환경 차이 최소화

---

## ⚠️ 고려사항 및 예외 처리 (Policy & Validation)

확장자 정책은 단순 CRUD보다  
**규칙의 일관성과 데이터 정합성**이 중요하다고 판단했습니다.

### 1️⃣ 입력값 정규화 (Normalization)

사용자 입력은 다음과 같이 다양하게 들어올 수 있습니다.

- `exe`, `EXE`, ` Exe `
- `.exe`
- `exe `

정책 판단 이전에 항상 정규화를 수행했습니다.

- 앞/뒤 공백 제거 (`trim`)
- 소문자 통일 (`toLowerCase`)
- 점(`.`) 제거
- 정규화 후 빈 값이면 요청 거절

> 동일 의미의 확장자가 서로 다른 값으로 저장되는 문제 방지

---

### 2️⃣ 중복 처리 규칙 (고정/커스텀 공통)

확장자는 **정책상 유일한 값**이어야 하므로  
다음 경우 모두 중복으로 처리했습니다.

- 커스텀 확장자에 이미 존재
- 고정 확장자에 이미 존재

즉, **type과 관계없이 name 기준으로 전체에서 유일**하도록 설계했습니다.

> 고정/커스텀에 동일 확장자가 동시에 존재할 경우  
> 정책 판단이 모호해질 수 있기 때문에 저장 단계에서 차단했습니다.

---

### 3️⃣ 고정 확장자 정책

- FIXED 타입은 삭제 불가
- 차단 상태(`blocked`)만 변경 가능
- 토글 시 즉시 DB 저장
- 새로고침 후에도 동일한 상태 유지

---

### 4️⃣ 커스텀 확장자 정책

- 입력 길이 최대 20자 제한
- 최대 200개까지 추가 가능
- 중복 확장자 추가 불가
- 삭제 시 DB에서 제거 후 화면 즉시 반영

---

### 5️⃣ 상태 유지 전략

- 모든 화면은 **DB 조회 결과 기준으로 렌더링**
- 프론트 상태에 의존하지 않고 서버 상태를 단일 기준으로 사용
- 정책 변경 후 재조회 시 항상 동일한 결과 보장

---

### 6️⃣ HTTP 상태코드 기반 예외 처리

정책 위반 요청에 대해 상태코드를 명확히 구분했습니다.

| 상황 | HTTP Status |
|----|------------|
| 잘못된 입력값(빈 값, 길이 초과) | 400 Bad Request |
| 중복 확장자 추가 시도 | 409 Conflict |
| 존재하지 않는 확장자 접근 | 404 Not Found |
| 고정 확장자 삭제 시도 | 400 Bad Request |
| 커스텀 확장자 200개 초과 | 400 Bad Request |

> 클라이언트가 실패 원인을 명확히 인지할 수 있도록 상태코드를 구분했습니다.

---

## 🧪 테스트

<img width="1818" height="771" alt="image" src="https://github.com/user-attachments/assets/e39930c0-6266-4afa-8ce5-0a125aafafd5" />

- Swagger UI를 통해 모든 API 직접 호출
- 테스트 시나리오:
  - 확장자 목록 조회
  - 고정 확장자 차단 토글
  - 커스텀 확장자 추가/삭제
  - 예외 상황(중복, 잘못된 입력) 확인

---

## 🚀 배포 방식

- Render 기반 Docker 배포
- 검토 편의를 우선한 데모 환경 구성


---


## 🔄 개발 진행 방식 (Issue 기반 작업 관리)

본 프로젝트는 기능 구현 단위로 작업을 나누어  
**GitHub Issue → Commit → Pull Request** 흐름으로 개발을 진행했습니다.

- 각 기능 및 변경 사항을 이슈로 정의
- 이슈 단위로 커밋을 관리
- 기능 완성 후 PR을 통해 병합

이를 통해 작업 범위와 변경 이력을 명확히 관리하고,  
실제 협업 환경에서의 개발 흐름을 최대한 반영하고자 했습니다.

<img width="1382" height="652" alt="image" src="https://github.com/user-attachments/assets/224f46c1-3cfc-4c53-9ba2-33ce71c914ea" />
<img width="1153" height="712" alt="image" src="https://github.com/user-attachments/assets/fad81a26-2eba-42a0-8000-8ff245ee814a" />



## ✍️ 회고

이번 프로젝트를 통해  
주어진 요구사항을 그대로 구현하는 것보다,  
**정책의 일관성과 예외 처리 기준을 먼저 정의하는 것이 중요하다는 점**을 느꼈습니다.

실제 서비스 환경이라면:
- 외부 DB 연동을 통한 정책 영속성 강화
- 관리자 권한 분리
- 정책 변경 이력 및 감사 로그 추가

와 같은 확장을 고려해보고 싶습니다.
